\documentclass[review,authoryear]{elsarticle}
%\documentclass[12pt]{article}
\usepackage{lineno,hyperref}
\usepackage{graphicx}
\usepackage[margin=2cm]{geometry}

\pdfstringdefDisableCommands{%
%  \def${}%
  \def\alpha{alpha}%
  \def\({}%
  \def\){}%
  \def\texttt#1{<#1>}%
}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{xcolor}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newcommand{\origB}{{b}}
\newcommand{\origW}{{w}}
\newcommand{\origAlpha}{{\alpha}}
\newcommand{\origK}{{K}}
\newcommand{\origGamma}{{\gamma}}
\newcommand{\origA}{{a}}
\newcommand{\origC}{{c}}
\newcommand{\origD}{{d}}
\newcommand{\origG}{{g}}
\newcommand{\origL}{{L}}
\newcommand{\origP}[1]{{p}(#1)}
\newcommand{\origTheta}{{\theta}}
\newcommand{\origT}{{t}}
\newcommand{\origMu}{{\mu}}

\newcommand{\scaledB}{\hat{b}}
\newcommand{\scaledW}{\hat{w}}
\newcommand{\scaledAlpha}{\hat{\alpha}}
\newcommand{\scaledK}{\hat{K}}
\newcommand{\scaledGamma}{\hat{\gamma}}
\newcommand{\scaledA}{\hat{a}}
\newcommand{\scaledC}{\hat{c}}
\newcommand{\scaledD}{\hat{d}}
\newcommand{\scaledG}{\hat{g}}
\newcommand{\scaledL}{\hat{L}}
\newcommand{\scaledP}[1]{\hat{p}(#1)}
\newcommand{\scaledTheta}{\hat{\theta}}
\newcommand{\scaledT}{\hat{t}}
\newcommand{\scaledMu}{\hat{\mu}}
\newcommand{\scaledM}{\hat{m}}


\modulolinenumbers[5]
% https://www.overleaf.com/project/5eb9da10e929ab0001816b1e
\journal{Ecological Modeling}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}
%%https://www.overleaf.com/project/5eb9da10e929ab0001816b1e
%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
%\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%


%% Available colors:  black, blue, brown, cyan, darkgray, gray, green, lightgray, %lime, magenta, olive, orange, pink, purple, red, teal, violet, white, yellow.
\begin{document}

\begin{frontmatter}

\title{A Continuous Model Of Behavioural Phenotype: An Example Of
  Interaction Between The Butterfly \textit{Pieris brasicae} And
  \textit{Trichogramma} Wasps}
%\tnotetext[mytitlenote]{Fully documented templates are available in the elsarticle package on \href{http://www.ctan.org/tex-archive/macros/latex/contrib/elsarticle}{CTAN}.}

%% Group authors per affiliation:
\author[math]{Kelly Black\fnref{myfootnote}}\author[math]{Malcolm R Adams}\author[math]{Aladeen Al Basheer}\author[math,engineering]{Caner Kazanci}\author[odum]{Bernard Patten}\author[odum]{Stuart Whipple}\author[math]{Sofya Zaytseva}

\fntext[myfootnote]{Corresponding author, kjblack@gmail.com}
\address[math]{Department of Mathematics, University of Georgia, Athens, GA 30602, USA}
\address[engineering]{College of Engineering, University of Georgia, Athens, GA 30602, USA}
\address[odum]{Odum School of Ecology and College of Engineering, University of Georgia, Athens, GA 30602, USA}



\begin{abstract}
TO DO: include an abstract
Discuss diffusion!
\end{abstract}

\begin{keyword}
behavioral phenotype, genetic variation, population dynamics, group phenotypic composition
\end{keyword}

\end{frontmatter}

\linenumbers


\section{Introduction}

The variation of animal personalities may play an important role in broader population dynamics \citep{doi:10.1111/j.1461-0248.2010.01536.x}.  The variation in animal behaviours as well as the variation in the corresponding genetic basis for animal personalities have multiple roles in how they impact species interactions \citep{doi:10.1111/j.1461-0248.2010.01536.x,doi:10.1086/687235,mierzejewski_horn_luong_2019,SANTICCHIA20191,doi:10.1098/rspb.2014.1016,FARINE2015609,sibbald2009individual,kurvers2011effect,modlmeier2012diverse,doi:10.1037/0735-7036.107.3.250}.  As the recognition for this important phenomenon grows, several techniques,  including compartment models, stochastic
models, agent based models, and combinations of these
approaches, have been developed to explore this important aspect of species interactions  \citep{Keeling65,doi:10.1086/687235,doi:10.1098/rspb.2001.1599,SuperspreadingLloyd}.  One difficulty, though, with such approaches is the
challenge of developing appropriate analytic models at the requisite granularity needed to model a wide range of behavioural manifestations. Current approaches do not scale well to address this concern. For example, refining the granularity by increasing the number of levels representing the differences in animal behavior in a compartment model or an agent based model can make it more difficult to interpret and analyze the resulting system of equations. 

We propose an approach that assumes a continuous distribution
associated with a single behavioural aspect of an animal's behaviour. The temporal dynamics of the distribution is modeled as a diffusion process. In
this initial exploration of this approach, we choose to model a relatively
straight-forward interaction in order to demonstrate its viability. Our model is based on
the interactions between parasitic wasps of the genus
\textit{Trichogramma}, and the butterfly \textit{Pieris
  brasicae} \citep{10.1093/beheco/arq007}.  The propensity of
\textit{Pieris brasicae} to employ a chemical associated with mating
behaviour is modeled as a continuous distribution.

While the original system of interactions involves multiple species, we consider a simplified system consisting of two species, butterflies and wasps.  The interaction between the two species depends on a pheromone that can be used by the males of the butterfly population. The pheromone associated with mating is meant to give the butterflies a benefit in survival, but paradoxically it is also an attractant for the wasp, which parasitizes the eggs. The two opposing pressures on the butterflies' use of the chemical provide an interesting question of determining the optimal level for the expression of this behavior.

Our discussion of these interactions is organized as follows. We first provide a more detailed overview of behavioural phenotypes
including some previous efforts to model the phenomena. Next, the
model used to provide insight into the phenomena is developed.
To account for the long interaction time to find and parasitize the butterflies' eggs a predator-prey relationship  with a Holling type II response \citep{TEWA20134825,holling_1959A,holling_1959B} is assumed. We adapt the type II response to accommodate a continuous
variation in one behaviour.  Following the derivation of the model, an equilibrium analysis of the system is explored. Finally, some results from our numerical explorations are provided including notes of the ecological implications. Separate appendices are included with a more detailed analysis of the model as well as details on the numerical approximation of the full model.

\section{Behavioral Phenotype}
\label{section:behaviouralPhenotype}

The primary motivation for why the distribution of how animals behave
and interact is given in this section. We begin with a discussion of
the basic idea of behavioural phenotype. Next, a brief overview of
existing modeling efforts is provided. Finally a specific example of
social spiders is discussed. In this example the phenomenon
is
directly observed, providing context for the importance of the
general phenomenon.

A number of authors have noted the importance of variation
in a species' habits or
genetics \citep{doi:10.1111/j.1461-0248.2010.01536.x,doi:10.1086/687235,mierzejewski_horn_luong_2019,SANTICCHIA20191,doi:10.1098/rspb.2014.1016}. This variation is sometimes referred to as group phenotypic composition \citep{FARINE2015609}, and it is observed in many species of animals such as sheep, barnacle geese, ants, spiders, fish and wild birds among others \citep{sibbald2009individual,kurvers2011effect,modlmeier2012diverse,doi:10.1086/687235,doi:10.1098/rspb.2014.1016,doi:10.1037/0735-7036.107.3.250}.
A broad discussion by  \citep{doi:10.1111/j.1461-0248.2010.01536.x} includes a description of variation in behavioural trains and includes multiple examples of the different ways it can impact a population. For example, varying levels of boldness result in different levels of exposure. Also, varying levels of social interaction result in different rates of transmissions between individuals. They go on to  propose that the diversity of
behaviours can profoundly impact the broader dynamics of the focal population as well as the populations that interact with them.


% https://www.semanticscholar.org/paper/Fish-behavioral-types-and-their-ecological-Mittelbach-Ballew/a381cb0b64a8107c694454e940fd7972263a8b77
% https://www.semanticscholar.org/paper/Are-most-samples-of-animals-systematically-biased-Biro/72eaa11f60d3b211f34ab04ff95211307978223b

Another example is provided by \cite{doi:10.1098/rspb.2014.1016} in a study of the effect of individual-level personality traits on the collective movement and feeding behavior of wild birds. In particular, they investigated how patch-level behaviour changes for groups with different personality types - reactive individuals that displayed low-risk behavior and proactive individuals that displayed high-risk behavior. They found that  reactive individuals were more likely to choose a single foraging location to minimize the risk of predation, and proactive individuals were more likely to disperse. The groups that contained a combination of the two types showed both group cohesiveness and patch exploration, indicating that behavioral variation can lead to better overall success, as was previously found in other animals such as ants and spiders \citep{ doi:10.1086/687235,modlmeier2011productivity,modlmeier2012diverse}.

A wide array of approaches to model the population responses to behaviour variation have been explored, including stochastic
models \citep{Keeling65}, agent based models \citep{doi:10.1086/687235},
hybrid models employing compartment models based on a stochastic
distribution \citep{doi:10.1098/rspb.2001.1599}, and statistical
models \citep{SuperspreadingLloyd}. A brief description of some of these
approaches is provided below.

An example of a stochastic model is provided by \cite{Keeling65}. They note that the dynamics of the incidence
of measles is influenced by how the incubation time varies across
individuals. In response to this observation they modified a standard
disease model by incorporating a time delay of the infected class using a convolution. They examine the impact of variation and the distribution associated with the variation in incubation times for the frequency of infectious outbreaks. They note that the distribution associated with the variation plays an important role in determining the frequency of outbreaks.


Another adaptation for a similar problem was proposed by \cite{doi:10.1098/rspb.2001.1599}. In this case the rates that
infected individuals leave the infected class is based on a stochastic
distribution. The phenomena was modeled by making use of a large
number of compartments representing infected classes with different removal rates, where the entry into the different classes is
governed by the underlying probability distribution.

An example of a statistical approach that highlights the importance of
responses to individual variation is given by \cite{SuperspreadingLloyd}, where they investigate the influence of individual variation in infectiousness on disease emergence. In their work the transmission of
disease is examined using a branching process. The varying
transmission rates between individuals are treated as a given
probability distribution. They find out that model predictions accounting for the individual variation differ sharply from average-based approaches for the estimation of transmission rates.

A mathematical model examining the interactions within a colony of
social spiders, \textit{Stegodyphus dumicola}, is provided by \cite{doi:10.1086/687235}. They  examine the impact of different boldness levels of
 key individuals on the success of the colony.  They note a small number of individuals within
a colony may exhibit different levels of aggression, and this small
number of individuals can have a disproportionate impact on the
broader success of the colony.

As a means to model this important aspect of a colony, \cite{doi:10.1086/687235} provide a computational model
consisting of an agent based model with a stochastically generated
population. Their approach is based on a small number of rules that
result in a distribution of behaviours. The temporal interactions
within the colony are approximated via discrete time steps and
stochastic decision making. The external interactions are approximated
using an ordinary differential equation model.
In the resulting statistical analyses, \cite{doi:10.1086/687235} found that different levels of boldness
within key individuals resulted in broader impacts across the colony. One difference that was noted is differences in
boldness impacted the prey capture rate for the colony. Another difference noted is
the rules governing the distribution of aggression also impacted the spread of disease across the broader population.

The differences noted above represent a challenge with respect to measuring and detecting individual variation experimentally \cite{doi:10.1037/0735-7036.107.3.250}. In addition, 
many of the existing mathematical models have been
developed in the context of the spread of an infectious disease. Only
a few approaches have been described for predator-prey systems, and
the majority of such models have been derived from statistical or
agent based approaches. The model presented here is a departure from
such approaches and offers a novel deterministic method.


\section{Modeling Genetic Variance As a Continuous Distribution}

Rather than a discrete or a continuous compartmental model or an agent based model, a
coupled partial differential equation model with a continuous, distributed parameter representing individual variation  is proposed. First, an overview of the specific system, the interactions
between butterflies and a parasitic wasp, is given. Next, the
model is derived. Finally, the analysis of a simplified system of
ordinary differential equations is examined as a way to gain some
preliminary insights into the partial differential equation model.

\subsection{Butterflies v. Wasps}
\label{butterflyVWasps}

The
model developed here focuses on the interaction between butterflies,
\textit{Pieris brasicae}, and \textit{Trichogramma} wasps that prey on
the butterflies' eggs. The interactions between these populations have
received a good deal of attention
\citep{PMC2797620,doi:10.1111/j.1439-0418.1986.tb00834.x,Figueroa2010AttractionOT,10.3389/fpls.2019.01768}. We
focus on the results of one source in particular  \cite{10.1093/beheco/arq007}. In their work, the authors state
that the pressure placed on the butterfly population due to the wasps'
interactions results in a change in the long term behaviour of the
butterfly population.

The source of this pressure is the nature of the mating practices of
\textit{Pieris brasicae}. In order to attract a mate, the female
butterflies tend to emit a pheromone designed to attract the males to
the females. After copulation, though, it is not in either the
female's nor the male's best interest to continue to attract other
butterflies. In response, the male butterflies have a propensity to
apply another pheromone, referred to as an anti-aphrodisiac, that will
reduce the effectiveness of the original pheromone emitted by the
female.

The downside to the use of the pheromone is that it exposes the eggs
to a greater risk of predation, as some species of \textit{Trichogramma}
wasps parasitize the eggs of the butterflies. Sometimes they
physically attach themselves to a butterfly and ride it until the
butterfly begins to attach their eggs in a preferable location. The
wasps are able to detect the presence of the anti-aphrodisiac which is
a useful strategy, as a butterfly with the
anti-aphrodisiac is more likely to lay eggs. In response, the wasps
are more likely to ride on a butterfly if they detect the
anti-aphrodisiac. It is important to note that this method of predation on
a butterfly's eggs requires a non-trivial time commitment with respect
to handling and detecting the presence of the eggs.

The authors \cite{10.1093/beheco/arq007} note that the probability that
a male will make use of the anti-aphrodisiac varies between
individuals. There are different trade-offs in the use of the
anti-aphrodisiac, but the authors found that the wasps' actions are
applying direct evolutionary pressure with respect to the habits of
the butterflies. In particular they provide evidence that the
distribution of the propensity of the male butterflies to make use of
the anti-aphrodisiac is changing in time, and over time a growing
number of butterflies are less likely to engage in the behaviour.

\subsection{Modeling Behavioural Phenotype As a Continuous
  Distribution}

As mentioned in section \ref{section:behaviouralPhenotype}, a number
of options have been employed to model the distribution of behavioural
preferences in a given population. These methods include compartmental
models, agent based models, and hybrids of these two models. One
potential issue, though, is that the number of variations can be quite
high. For example \cite{doi:10.1111/mec.14878} examined a system in
which over 120 genetic sites determine a given animal's
propensity. The resulting number of
combinations of such sites can be extremely high.

Rather than treat the possible behaviours as a discrete distribution
we instead treat it as a continuous distribution. The way in which
this manifests itself within a model is to treat the population as a
distribution with respect to the new parameter. This new independent
variable is introduced within the model, and the parameter is now a
function that will vary as the independent variable varies.

At first glance, this is akin to a Bayesian statistical approach that
is often used to estimate the value of a
parameter\citep{doi:10.1111/j.1467-9868.2007.00610.x,Fitzpatrick_1991}. In
these approaches a probability distribution is assumed to describe the
likelihood that a parameter takes on a given range of values. In our
case, though, we turn this around and assume that the population
itself varies, and the relative population density depends on the
underlying variable.

A question arises about how to translate the impact of this parameter
within a given model. In this initial examination of the approach we
employ the simplest option and assume a linear impact with respect to
the new independent variable. In particular, for the interactions
between the butterflies and wasps we track the population densities of
the two populations. The interactions between the two species result
in direct mortality on the potential offspring, and therefore we assume a
predator-prey relationship rather than a disease like relationship
modeled in other parasitic systems. 

The system is adapted from \cite{TEWA20134825}. We
first focus on the model as a system of ordinary differential
equations and later adapt it for the distributed system described
above. The basic assumption is that in the absence of predation the
butterfly population will act in a way consistent with the logistic
equation. In the absence of any butterflies the wasps will slowly die
out. For this particular system, however, the \textit{Trichogramma}
wasps are generalist predators, and this is an assumption that should
be revisited beyond this initial investigation.  To account for the
substantial time the wasps require to follow the butterflies and allow
them to oviposit their eggs, we assume the rate of predation to be
approximated as a type II Holling response\citep{TEWA20134825}.  The
resulting ordinary differential equation is given by
\begin{eqnarray}
  \label{eq:initialSystem1}
  \frac{d}{d\origT} \origB(\origT) & = & \underbrace{\origAlpha \cdot \origB(\origT) (\origK - \origB(\origT))}_\text{logistic growth}
                               - \underbrace{\origGamma \cdot \origW(\origT) \frac{\origB(\origT)}{\origC+\origB(\origT)}}_\text{predation by wasps}, \\
  \label{eq:initialSystem2}
  \frac{d}{d\origT} \origW(\origT) & = & -\underbrace{\origD \cdot \origW(\origT)}_\text{natural death} + \underbrace{\origG \cdot \origW(\origT) \frac{\origB(\origT)}{\origC+\origB(\origT)}}_\text{feeding}.
\end{eqnarray}
The density of butterflies is modeled by the function
$\origB(\origT)$, the density of wasps is modeled by the function
$\origW(\origT)$, and the parameters $\origA$, $\origK$, $\origC$,
$\origGamma$, $\origD$, and $\origG$ are positive constants. (The variables are denoted with hats so that when we rescale the parameters and variables to a dimensionless model we can remove the hats for the remainder of the exposition.)
 
The butterflies do not behave uniformly with respect to their decision
to make use of the anti-pheromone, and different butterflies have a
different propensity to use the anti-pheromone. In this treatment, we
do not model the male and female populations separately, but treat
them as a single population that intermingles in a relatively uniform
fashion. The propensity for a butterfly to make use of the
anti-pheromone depends on a new parameter, $\origTheta$. The value of
$\origTheta$ is assumed to vary between $0$ and some positive constant,
$\origL$, and the larger the value of $\origTheta$ the more likely an
individual is to make use of the anti-pheromone. The distribution of
the population of butterflies is now dependent on both the time and
the new parameter,
\begin{eqnarray}
  \origB & = & \origB(\origT,\origTheta).
\end{eqnarray}

Our first task is to determine how the Holling type II response,
should be expressed in this new context. Formal derivations of the
response function for the case given in equations
(\ref{eq:initialSystem1}) and (\ref{eq:initialSystem2}) are provided
by \cite{DAWES201311}.  In the derivation here,
however, we follow the approach in Holling's original
discussion\citep{holling_1959A,holling_1959B}. We begin by finding an
expression that relates the number of eggs parasitized by a single
wasp, $Y(\origTheta)$, which is assumed to be a linear relationship,
\begin{eqnarray}
  \label{eq:processingTime}
  Y(\origTheta) & = & r T_{\mathrm{search}}(\origTheta) \origB(\origT,\origTheta) \origP{\origTheta},
\end{eqnarray}
where $T_{\mathrm{search}}$ is the search time required by the wasp to
find the location of a butterfly's clutch. The motivation for this is
that the higher the value of $\origTheta$ the higher the success rate for
a given wasp.  The time a wasp requires to parasitize the clutch is
assumed to be proportional to the number of eggs, and the total time
is
\begin{eqnarray}
  \label{eq:totalEgglayingTime}
  T_{\mathrm{total}}(\origTheta) & = & T_{\mathrm{search}}(\origTheta) + \beta Y(\origTheta).
\end{eqnarray}
Substituting the search time found in equation
(\ref{eq:totalEgglayingTime}) back into equation
(\ref{eq:processingTime}) results in an expression for the rate of
predation per wasp,
\begin{eqnarray}
  \label{eq:waspPredationRate}
  Y(\origTheta) & = & \frac{r T_{\mathrm{total}} \origB(\origT,\origTheta) \origP{\origTheta}}{1 + \beta r \origB(\origT,\origTheta) \origP{\origTheta}}.
\end{eqnarray}

In this case $\origP{\origTheta}$ represents the impact associated with the use
of the anti-pheromone. As $\origTheta$ increases the more likely an
individual butterfly is to make use of the anti-pheromone and the more
likely a wasp is to locate and ride along with a butterfly. The
function, $\origP{\origTheta}$, will be used to balance the positive and
negative impacts in the growth as well as the predation terms in
equation (\ref{eq:initialSystem1}), and the parameters $\origAlpha$ and
$\origGamma$ provide relative scales for the two impacts. Note that we can
normalize $\origP{\origTheta}$ because it is scaled by the parameter $r$.


Turning back to equation (\ref{eq:waspPredationRate}), the rate of
predation can now be approximated.  The result can be immediately
substituted into equation (\ref{eq:initialSystem1}) in the more
traditional form as
\begin{eqnarray}
  \label{eq:butterflyPredationRate}
  \origGamma \cdot w(\origT) \frac{\origP{\origTheta} \origB(\origT,\origTheta) }{\origC +  \origP{\origTheta} \origB(\origT,\origTheta)},
\end{eqnarray}
where $\origC=\frac{1}{\beta r}$ and
$\origGamma=\frac{T_{\mathrm{total}}}{\beta}$.  Looking back at the
original predator-prey system, in particular equation
(\ref{eq:initialSystem2}), the rate of predation for the single wasp
population must accommodate the variation across all butterflies, and
the impact for the wasps must be accumulated across the entire
butterfly population,
\begin{eqnarray}
  \label{eq:totalWaspPredationRate}
  \int^{\origL}_{\origTheta=0} \origG \cdot \origW(\origT) \frac{\origP{\origTheta} \origB(\origT,\origTheta) }{\origC + \origP{\origTheta} \origB(\origT,\origTheta)} ~ d\origTheta.
\end{eqnarray}

We are almost ready to put these terms together for the current
model. It is assumed that the mixing and interactions within the
butterfly population are uniform, and the diffusion of the trait
roughly follows Fick's law\citep{logan2006applied}. This diffusion term is not with respect to a spatial variable as is normally seen, rather it is with respect to the introduced variable for the propensity to make use of the pheromone. Here, a second
order derivative term approximates the sharing of the genetic
information relative to the propensity to use the
anti-aphrodisiac. The result is a coupled PDE and ODE system given by
\begin{eqnarray}
  \label{eq:odePDE1}
  \frac{\partial}{\partial \origT} \origB(\origT,\origTheta) & = &
     \underbrace{  \origAlpha \cdot \origP{\origTheta} \origB(\origT,\origTheta) (\origK - \origB(\origT,\origTheta)) }_\text{trait dependent logistic growth}
      -  \underbrace{\origGamma \cdot \origW(\origT) \frac{\origP{\origTheta} \origB(\origT,\origTheta)}{\origC+\origP{\origTheta}\origB(\origT,\origTheta)} }_\text{trait dependent predation by wasps}
      +  \underbrace{\origMu \frac{\partial^2}{\partial \origTheta^2} \origB(\origT,\origTheta)}_\text{diffusion of trait within population}, \\
  \label{eq:odePDE2}
  \frac{d}{d\origT} \origW(\origT) & = & - \underbrace{ \origD \cdot \origW(\origT) }_\text{natural death}  +
        \underbrace{
          \int^{\origL}_{\origTheta=0} \origG \cdot \origW(\origT) \frac{\origP{\origTheta} \origB(\origT,\origTheta) }{\origC + \origP{\origTheta} \origB(\origT,\origTheta)} ~ d\origTheta
       }_\text{net impact of feeding on butterflies across different trait levels }.
\end{eqnarray}

As previously noted, the function $\origP{\origTheta}$ is assumed to be an
increasing function for $0\leq\origTheta\leq \origL$, and $\origP{0}>0$. If
$\origP{\origTheta}$ is zero then equation (\ref{eq:initialSystem1}) will
indicate no growth and no predation. We can assume $\origP{\origTheta}$ has a
minimal value, $a>0$,  at $\origTheta = 0$, i.e. $\origP{0}=a$, and the relationship has a positive slope. We
examine the simplest such relationship, a linear function.

This function is scaled separately in equations (\ref{eq:odePDE1}) and
(\ref{eq:odePDE2}), and the function can be scaled in an arbitrary
manner. We choose to scale the function so that its integral is one,
\begin{eqnarray*}
  \int^{\origL}_0 \origP{\origTheta} ~ d\origTheta & = & 1,
\end{eqnarray*}
and the resulting normalized form is
\begin{eqnarray}
  \label{eq:linearFormP}
  \origP{\origTheta} & = & \origA + \frac{2(1-\origA\origL)}{\origL^2} \origTheta.
\end{eqnarray}
One immediate restriction on the parameters requires that
$0<\origA\origL<1$. The total variation in the observed trait is given by 
$\origP{\origL} - \origP{0} =\frac{2(1-\origA\origL)}{\origL}$.

\begin{table}[ht]
  \centering
  \begin{tabular}{r|l}
    Scaling Factor & Value \\ \hline
    $\bar{B}$ & $\origK$ \\ [10pt]
    $\bar{W}$ & $\frac{\origAlpha \origK^2 \origA}{\origGamma}$ \\  [10pt]
    $\bar{T}$ & $\frac{1}{\origAlpha \origK \origA}$ \\  [10pt]
    $\bar{\Theta}$ & $\origL$
  \end{tabular}
  \caption{Choices made for scaling the variables to take advantage of the interdependence of the parameters}
  \label{tab:scalingChoices}
\end{table}

\begin{table}[ht]
  \centering
  \begin{tabular}{r|l}
  Original Parameter & Scaled Value \\ \hline
    $m$   & $\frac{2(1-\origA\origL)}{\origA\origL}$, \\  [10pt]
    $c$   & $\frac{\origC}{\origK\origA}$ \\  [10pt]
    $d$   & $\frac{\origD}{\origAlpha\origK\origA}$ \\  [10pt]
    $\mu$ & $\frac{\origMu}{\origAlpha\origK\origA\origL^2}$  \\  [10pt]
    $g$   & $\frac{\origL\origG}{\origAlpha\origK\origA}$
  \end{tabular}
  \caption{New values of parameters after scaling}
  \label{tab:newParameters}
\end{table}


The variables can be scaled as $\origB\rightarrow \bar{B}\scaledB$,
$\origW\rightarrow \bar{W}\scaledW$, $\origT\rightarrow \bar{T}\scaledT$, and
$\origTheta\rightarrow \bar{\Theta}\scaledTheta$. The choices made for our
scalings can be found in Table \ref{tab:scalingChoices}, and the
corresponding transformations for the new parameters can be found in
Table \ref{tab:newParameters}.  The resulting system can be reduced to
the following form
\begin{eqnarray}
  \label{eq:scaledodePDE1}
  \frac{\partial}{\partial \scaledT} \scaledB & = &
      p(\theta) \scaledB (1 - \scaledB)
      -  \scaledW \frac{\scaledP{\theta} \scaledB}{\scaledC+\scaledP{\scaledTheta}\scaledB}
      + \scaledMu \frac{\partial^2}{\partial \scaledTheta^2} \scaledB , \\
  \label{eq:scaledodePDE2}
  \frac{d}{d\scaledT} \scaledW & = & -\scaledD \cdot \scaledW +
      \int^1_{\scaledTheta=0} \scaledG \cdot \scaledW \frac{\scaledP{\scaledTheta} \scaledB }{\scaledC + \scaledP{\scaledTheta} \scaledB} ~ d\scaledTheta,
\end{eqnarray}
where
\begin{eqnarray}
    \label{eq:definitionP}
  \scaledP{\scaledTheta} & = & 1 + \scaledM \cdot \scaledTheta.
\end{eqnarray}
The domain for the scaled independent variable, $\scaledTheta$, is
$0\leq\scaledTheta\leq 1$. As previously noted, the slope, $\scaledM$, can be
interpreted to indicate how much variation in the trait is present in
a population. The larger $\scaledM$ is the greater the amount of variation.
With respect to the PDE, Neumann boundary conditions are used in the
subsequent numerical approximations below,
\begin{eqnarray*}
  \frac{\partial}{\partial\scaledTheta} \scaledB(\scaledT,\scaledTheta) \bigg|_{\scaledTheta=0} & = & 0, \\
  \frac{\partial}{\partial\scaledTheta} \scaledB(\scaledT,\scaledTheta) \bigg|_{\scaledTheta=1} & = & 0. \\
\end{eqnarray*}
We have not yet defined the initial conditions, and
a variety of initial
conditions have been explored. More details are  described in the results
section, section \ref{section:results}. For the sake of clarity, the notation for the scaled variables will revert to a cleaner notation similar to that originally stated. For the subsequent sections we will focus on these scaled equations.


\subsection{Parameter Dependence on Stability of the System}
\label{subsection:parameters}

Prior to examining the behaviour of the distributed system given in
equations \ref{eq:odePDE1} and \ref{eq:odePDE2}, the potential
restrictions on the parameters are explored. We first examine a
simplified system based on a system of ordinary differential
equations.  The focus is on the impact of the parameters of the
system prior to examining the fully distributed system, and a more complete analysis is provided in 
\ref{appendix:otherFixedPoints} and \ref{appendix:stability}.

The simplified system is found by examining an ODE with a similar form
as the distributed system. By assuming that the distribution of the
butterflies is a constant, and the entire population is concentrated on a single, constant 
value of $\theta$, the system is approximated by the following system
of ODEs:
\begin{eqnarray}
  \label{eq:scaledODE1}
  \frac{d}{dt} b(t) & = &
      p(\theta) b(t) (1 - b(t))
      -  w(t) \frac{p(\theta) b(t)}{c+p(\theta)b(t)}, \\
  \label{eq:scaledODE2}
  \frac{d}{dt} w(t) & = & -d \; w(t) +
       g \; w(t) \frac{p(\theta) b(t) }{c + p(\theta) b(t)}.
\end{eqnarray}
In the subsequent examination of the approximation of the fully distributed system (the coupled PDE and ODE), the distribution of the butterflies is a function of $\theta$. The net effect is to produce a population whose characteristics extend along a distribution for $0\leq\theta\leq 1$.

By focusing on the system of ODEs, we can more easily examine an approximation to
the system by treating the variable $\theta$ as a fixed parameter and
can gain some insight into the distributed system which will incorporate the full domain of possible values of $\theta$. The analysis in
this section focuses on the stability of the linearized system at the
nontrivial fixed point. More details about the other fixed points are
provided in  \ref{appendix:otherFixedPoints} and  B.

We first determine the nullclines for the system.
The $b$-nullclines for the system in the $b,w$ plane are given by
\begin{eqnarray}
  \label{eq:bnullclines}
  b & = & 0, \\
  w & = & (1-b)(c+b\cdot(1+m\theta))
\end{eqnarray}
where the definition of $p(\theta)$ from equation (\ref{eq:definitionP}) has been substituted.
The second $b$-nullcline is a parabola opening downward, and the vertex is located at
$b=\frac{1+m\theta-c}{2(1+m\theta)}$. The $w$-nullclines are given by
\begin{eqnarray}
  \label{eq:wnullclines}
  w & = & 0, \\
  b & = & \frac{cd}{(g-d)(1+m\theta)}.
\end{eqnarray}
The second $w$-nullcline is a vertical line in the $b,w$ plane. (The second $w$-nullcline does not exist if $g=d$.) In
order for a fixed point to exist in the first quadrant an immediate
restriction on the parameters requires that $g>d$.  Given the
nullclines, there are three fixed points (as long as $g\ne d$), at $(0,0), (1,0)$ and $(b^*,w^*)$ with $b^*=\frac{cd}{(1+m\theta)(g-d)}$ and
$w^*=\left(\frac{cd}{g-d}+c\right)\left(1-\frac{cd}{(1+m\theta)(g-d)}\right)$.  This last fixed point is in the positive quadrant only if $g-d>0$ and
\begin{eqnarray}
\label{eqn:positivityRequirement}
\frac{c\,d}{g-d}<1+m\theta.
\end{eqnarray}


We now focus on the fixed point $(b^*,w^*)$ assuming it lies in the positive quadrant.
The Jacobian for the system in equations (\ref{eq:scaledODE1}) and
(\ref{eq:scaledODE2}) at the fixed point is
\begin{eqnarray}
  J ~ \bigg|_{(b^*,w^*)} & = &
          \left[
          \begin{array}{rr}
            J_{11} & J_{12} \\
            J_{21} & 0
          \end{array}
          \right],
\end{eqnarray}
where
\begin{eqnarray}
  \label{eq:jacobian}
  J_{11} & = & p(\theta)(1-2b^*) - w^* p(\theta)\frac{c}{(c+p(\theta)b^*)^2}, \\
  J_{12} & = & \frac{-b^*\cdot p(\theta)}{c+p(\theta)b^*}, \\
  J_{21} & = & \frac{g\cdot c \cdot w^* \cdot p(\theta)}{(c+p(\theta)b^*)^2}.
\end{eqnarray}
The value of $J_{12}$ is always negative, and the value of $J_{21}$ is always positive. Thus the determinant must be positive, and so both eigenvalues have the same sign.
Additionally, the eigenvalues of the Jacobian have negative real part when the
trace is negative, i.e.,
\begin{eqnarray}
  (1+m\theta)(1-2b^*) - w^* p(\theta)\frac{c}{(c+(1+m\theta)b^*)^2} & < & 0.
\end{eqnarray}
Substituting the values of $b^*$ and $w^*$ for the non-trivial fixed point
yields
\begin{eqnarray}
  \label{eqn:traceNegative}
  \frac{1+m\theta-c}{2} & < & \frac{c\,d}{g-d}.
\end{eqnarray}
This expression can be viewed through another substitution. Let
$u=\frac{c\,d}{g-d}$, and since
$1+m\theta>0$ the relationship in equation
(\ref{eqn:traceNegative}) is now
\begin{eqnarray}
  \label{eq:stabilityParameters}
  u & > & \frac{1+m\theta-c}{2}.
\end{eqnarray}
Note also that under this transformation, the value of the butterfly
density at the fixed point is $\frac{u}{1+m\theta}$. Our earlier assumption, equation (\ref{eqn:positivityRequirement}), requiring that the fixed point occurs in the first quadrant,  implying that
\begin{eqnarray}
  \label{eq:boundFixedPoint}
  u & < & 1+m\theta.
\end{eqnarray}
Combining these inequalities yields
\begin{equation}
  \begin{array}{rcccl}
  \frac{1+m\theta-c}{2}  & <  & u  & < & 1+m\theta.
  \end{array}
\end{equation}

The feasible region that implies stability of the fixed point can be
determined in the $(u,\theta)$-plane. Note that for the case of the ODE, $\theta$ is a fixed parameter. If the parameters result in a point in
the region bounded by equation (\ref{eq:stabilityParameters}),
equation (\ref{eq:boundFixedPoint}) then the resulting
fixed point will be linearly stable. A graphical depiction of the
stability region in the $u,\theta$ plane is shown in Figure
\ref{fig:uvStabilityRegion}. For the region above the line $u=1+m\theta$, there is no fixed point in the positive quadrant, but for the region below the line $u = \frac{1+m\theta-c}{2}$ there is still  a fixed point in the positive quadrant, however, it is unstable.  In the appendix, we will prove that this instability leads to the existence of a \emph{limit cycle}, implying oscillatory behavior of the butterfly and wasp populations. We summarize these results in 

\begin{theorem}  The system of ordinary differential equations given by equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) (with $g\ne d)$ has fixed points in the $(b,w)$-plane at the points $(0,0), (1,0),$ and $(b^*,w^*)$, where $b^*=\frac{cd}{(1+m\theta)(g-d)}$ and
$w^*=\left(\frac{cd}{g-d}+c\right)\left(1-\frac{cd}{(1+m\theta)(g-d)}\right)$.  The latter fixed point lies in the positive quadrant if $g-d>0$ and $u<1+m\theta$, where $u=\frac{cd}{g-d}.$
Furthermore, this fixed point is asymptotically stable when $u>\frac{1+m\theta-c}{2}$ and is unstable if $u<\frac{1+m\theta-c}{2}.$ However, when this fixed point is unstable, there exists at least one  limit cycle in the positive quadrant.

\end{theorem}

\begin{figure}[htb]
  \centering
  \includegraphics[width=10cm]{FIGURES/odeStability-uv-plane.pdf}
  \caption[Stability region in the $u,\theta$ plane.]{Graphical view of the
    combined feasible and stability region in the $u,\theta$ plane.}
  \label{fig:uvStabilityRegion}
\end{figure}

In the context of the full, distributed system in equation
(\ref{eq:scaledodePDE1}) and equation (\ref{eq:scaledodePDE2}) the
domain of $\theta$ is $0\leq\theta\leq 1$. For a given set of
parameters the value of $u$ is fully determined. The possible values of $\theta$
are from $\theta=0$ to $\theta=1$.  The corresponding region in the $u,\theta$
plane is along a horizontal line segment from $(0,u)$ to
$(1,u)$ as shown in Figure \ref{fig:distributedLineSegment}. We note that if the propensity for using the anti-pheromone within the butterfly population is high enough (corresponding to large values of $m$), the population may be destabilized (see Figure \ref{fig:distributedLineSegment}). As this result comes from the ODE system and does not take into consideration the differences in the individual behavior ($\theta$ is fixed), it is of interest how this can change once we allow for behavioral differences within the butterfly population. This will be explored in the next section where we summarize our findings for both the ODE and PDE systems and discuss how taking variation into account can give more insight into the dynamics of the population. 

\textcolor{blue}  {Actually, we should say more about stability here.  In the appendix, Aladeen proved that when the critical point becomes unstable (for high values of $\theta$, a stable limit cycle persists.  So I guess the system is still stable in a generalized sense, but periodic.}

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/odeStability-uv-plane-Line.pdf}
  \caption[Domain of the distributed system in the $u,\theta$
  plane.]{Domain of the parameters for the distributed system for a
    given set of parameters for $0\leq\theta\leq 1$. The dotted line
    represents the possible points in the plane
    for all values of $\theta$ between 0 and 1. The figure on the left is an example of a
    smaller value of $m$ while the figure on the right is an example
    of a larger value of $m$. The whole population shown in the figure
    on the left lie in a stable region, while part of the population
    shown in the figure on the right lie in an unstable region.}
  \label{fig:distributedLineSegment}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/ODEButterflyBounds.pdf}
  \caption[Upper and lower bounds of the butterfly density.]{The upper
    and lower bounds of the long term density of the butterfly
    population. The population was approximated for different values
    of $m$. The approximation was stopped if it either became close to
    a steady state or a limit cycle.}
  \label{fig:odeButterflyBifurcation}
\end{figure}




\section{Results}
\label{section:results}

A collection of specific approximations is provided. We start with an
examination of the behaviour of the system of ODEs given in equations
(\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}). Next approximations
of the coupled PDE and ODE from equations (\ref{eq:scaledodePDE1}) and
(\ref{eq:scaledodePDE2}) are provided. In both sets of examples a
numerical exploration of the existence of a stable steady state or
limit cycles is given.

The results given here rely on the numerical approximation of the two
systems previously discussed. In particular approximation for the
system of ODEs given in equations (\ref{eq:scaledODE1}) and
(\ref{eq:scaledODE2}) is constructed using a Runga-Kutta Fehlberg
method. Approximating the distributed system, equations
(\ref{eq:scaledodePDE1}) and (\ref{eq:scaledodePDE2}), requires a more
careful implementation. The approximation method is described in
Appendix \ref{numericalApproximation}.

\subsection{Approximation of the system of ODEs}
\label{subsection:odeApproximation}

We first examine the behaviour of the system of ODEs given in
equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}). Our focus
is on the stability characteristics of the fixed points as well as the
long term dynamics of the system. The behaviour at the non-trivial
fixed point is explored with respect to changes in the parameter
$m$, reflecting changes in the propensity of the male butterflies to use the anti-aphrodisiac. Because the ODE model does not take into consideration the variation in the behavioral phenotype, the change in $\theta$ is not relevant for the ODE and we 
assume that $\theta=1$.

An example of the long term behaviour is provided in Figure
\ref{fig:odeButterflyBifurcation}. The system of ODEs given in
equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) was
approximated using a Runga-Kutta Fehlberg method with a minimum step
size of 1.0E-5.  The value of the parameters in the example are
$c=2.8$, $g=0.6$, $d=0.1$. Approximations were constructed for values
of $m$ starting at $m=0.1$ and ending at $m=15.0$.

The approximation for the initial value of $m$ was started near the
non-trivial steady state, but the values of the butterflies and wasps
were taken to be 95\% of the values for the steady state. The
approximation was run until it detected the state was not changing or
a limit cycle was reached. In this case, if both densities did not
change more than 1.0E-7 from a previous high or low value for over
2000 time steps it was considered to be at a steady state. For the
limit cycle if the minimum and maximum for both densities was within
1.0E-7 for two full cycles then it was considered to be in a limit
cycle. \textcolor{red}{Should these details be moved in the appendix and only summarized here?}\textcolor{blue}{Yes.  we should just be discussing how figure 3 gives information about the butterfly population ... the details of how fig 3 was constructed go in an appendix.}

After the initial approximation, the initial condition for the next
value of $m$ was the end state of the previous approximation. This
process was done for the values of $m$ starting at the lowest value
and increasing. the process was then repeated for the value of $m$
starting at the highest value and decreasing. The results were nearly
identical, and no hysteresis was detected.

The results of the series of approximations are shown in Figure
\ref{fig:odeButterflyBifurcation}. The values of $m$ are given along
the horizontal axis, and the values of the butterfly densities are
given along the vertical axis. The values of the maximum and the
minimum values of the butterfly densities are plotted after the
approximation was terminated.

The value of $\theta$ is fixed at 1 for these approximations, and the Hopf bifurcation occurs at $m=2.92$. With respect to the numerical approximations, the system moved close to a steady state for values of $m$ less than about 2.841. For larger values of $m$ the system approached a limit
cycle. The resulting numerical simulations provide a close estimate of the location of the bifurcation.

\subsection{Approximation of the coupled PDE and ODE}

In this section we provide a  numerical exploration of the full, coupled system of the PDE and
ODE, equations (\ref{eq:scaledodePDE1}) and (\ref{eq:scaledodePDE2}). The details of the full approximation method are
described in appendix \ref{numericalApproximation}. The parameter
range is similar to that in subsection
\ref{subsection:odeApproximation}.

The value of the parameters in the example are $c=2.8$, $g=0.6$,
$d=0.1$, and $\mu=0.01$. The temporal behaviour of the system is
similar to that found in the previous subsection
\ref{subsection:odeApproximation}. For example, an approximation for
--- provide example for $m=5$. --- Need to discuss this.

The onset of a limit cycle is delayed with respect to the system of
ODEs. For this value of $m$ the fixed point for the ODEs results in a
limit cycle. However, in the case of the coupled PDE and ODE system a
limit cycle did not appear until much larger values of $m$. For
example, at $m=12$, a repeating patter was found. The results of an
approximation are shown in Figure \ref{fig:approximationM12Mu01}.

The results shown in Figure \ref{fig:approximationM12Mu01} are only
for a short time span in order to make it easier to show the change in
time. The initial condition in this case is a Gaussian with a center
at the right end point.  Similar patterns emerge for an initial
condition that is a Gaussian centered at the left, a constant initial
condition, and an initial condition with the butterfly density set at
the theoretical steady state given each value of $\theta$.


Approximations were constructed for
values of $m$ sarting at $m=0.1$ and ending at $m=15.0$.


\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/approximation-mu-01-m-12.pdf}
  \caption[Approximation with $m=12$ and $\mu=0.01$.]{Approximation of
    the system, $m=12$, $\mu=0.01$, $c=2.8$, $g=0.6$, and $d=0.1$. }
  \label{fig:approximationM12Mu01}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/approximation-mu-01-m-15.pdf}
  \caption[Approximation with $m=15$ and $\mu=0.01$.]{Approximation of
    the system, $m=15$, $\mu=0.01$, $c=2.8$, $g=0.6$, and $d=0.1$. }
  \label{fig:approximationM15Mu01}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/maxMinByM-mu-01-04.pdf}
  \caption[Maximum and minimum values of the butterfly
  density]{Maximum and minimum values of the butterfly densities after
    a long time period as the parameter $m$ varies.}
  \label{fig:maxMinButterflySmallMu}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/approximation-c-11-mu-01-m-01.pdf}
  \caption[Approximation with $c=1.1$, $m=0.01$ and $\mu=0.01$.]{Approximation of
    the system, $m=0.01$, $\mu=0.01$, $c=1.1$, $g=0.6$, and $d=0.1$. }
  \label{fig:approximationM01Mu01C11}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/approximation-c-11-mu-01-m-51.pdf}
  \caption[Approximation with $c=1.1$, $m=0.51$ and $\mu=0.01$.]{Approximation of
    the system, $m=0.51$, $\mu=0.01$, $c=1.1$, $g=0.6$, and $d=0.1$. }
  \label{fig:approximationM51Mu01C11}
\end{figure}


\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/approximation-c-11-mu-01-m-150.pdf}
  \caption[Approximation with $c=1.1$, $m=1.50$ and $\mu=0.01$.]{Approximation of
    the system, $m=1.50$, $\mu=0.01$, $c=1.1$, $g=0.6$, and $d=0.1$. }
  \label{fig:approximationM150Mu01C11}
\end{figure}
\textcolor{red}{The oscillations seem to be sustained for a relatively small window of $m$ values (Figures 4,5) when the diffusion is small. Is this still the case for Figures 7,8 and 9? How much does $m$ have to increase for the oscillations to disappear? 
\\Need to think of the significance of these figures and Figure 6 in the context of $\mu$ and $m$. Here are my quick thoughts on Fig 6: 1)without including variation in the trait, increases in the use of anti-aphrodisiac (larger $m$) results in the destabilization of the population (Figure 6,ode) 2) When variation is accounted for, but the change in the group phenotype composition changes slowly ($\mu$ is relatively small, and distribution of the trait doesn't change fast), the population can be sustained for higher propensities for using the anti-aphrodisiac within the population 3) As $\mu$ gets large (resulting in faster changes in the group phenotype composition and leading to more well-mixed population), the results start to resemble those of the ODE when increases in the use of anti-aphrodisiac result in the destabilization of the population.  }

\begin{figure}[htb]
  \centering
  \includegraphics[width=12cm]{FIGURES/maxMinByM-c-1.1.pdf}
  \caption[Maximum and minimum values of the butterfly
  density with $c=1.1$]{Maximum and minimum values of the butterfly densities after
    a long time period as the parameter $m$ varies. The value of $c$ for these approximations is 1.1.}
  \label{fig:maxMinButterflySmallMu-c-1.1}
\end{figure}


\section{Conclusion}

\section{Acknowledgements}

\clearpage

\appendix

\section{The Fixed Points On The $b$ and $w$ Axes}
\label{appendix:otherFixedPoints}

In subsection \ref{subsection:parameters} the stability of the
non-trivial fixed point in the positive quadrant was examined. More details about the other
fixed points as well as a more complete description of the Jacobian of
the system given in equations (\ref{eq:scaledODE1}) and
(\ref{eq:scaledODE2}) are provided here. In particular the other two
fixed points are given,  the Jacobian is stated, and the linear
stability at the other two fixed points is briefly explored.

The the system of equations given in by
(\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) has (at most) one fixed point
with both $b>0$ and $w>0$. There are two other fixed points on the boundary of the positive quadrant, i.e $b=0$ or $w=0$.  One is the fixed point at the origin, $b=0$ and $w=0$.
The remaining fixed point occurs at $w=0$ and $b=\frac{c\cdot
  d}{p(\theta)\left(g - d\right)}$. \textcolor{blue} {No, this fixed point is at b=1, w=0}
  

The stability at these two fixed points can be examined by first
determining the Jacobian of the system,
\begin{eqnarray*}
  J & = & \left[
          \begin{array}{rr}
            J_{11} & J_{12} \\
            J_{21} & J_{22}
          \end{array}
          \right].
\end{eqnarray*}
The values of the entries in the matrix are
\begin{eqnarray*}
  J_{11} & = & p(\theta)\left(1-2b\right) -
               \frac{w\cdot c \cdot p(\theta)}{\left( c + p(\theta)b \right)^2}, \\
  J_{12} & = & -\frac{p(\theta)b}{c+p(\theta)b}, \\
  J_{21} & = & g\cdot c \cdot  p(\theta) \frac{w}{\left(c+p(\theta)b\right)^2}, \\
  J_{22} & = & -d + g\cdot b \cdot  p(\theta) \frac{1}{c+p(\theta)b}.
\end{eqnarray*}

For the fixed point at the origin, the Jacobian can be expressed as 
\begin{eqnarray*}
  J~\bigg|_{(0,0)} & = & \left[
          \begin{array}{rr}
            p(\theta) & 0 \\
            0 & -d
          \end{array}
          \right].
\end{eqnarray*}
Since it is assumed that both $p(\theta)$ and $d$ are non-negative, this fixed point  is unstable  (saddle point).

For the fixed point at $w=0$ and
$b=\frac{c\cdot d}{p(\theta)\left(g - d\right)}$, the Jacobian can be
expressed as 
\begin{eqnarray*}
  J & = & \left[
          \begin{array}{cc}
            p(\theta)\left( 1 -
            \frac{2c\cdot d}{p(\theta)(g-d)} \right) & -\frac{d}{g} \\
            0 & 0
          \end{array}
          \right].
\end{eqnarray*}

As described in subsection \ref{subsection:parameters} it is assumed
that $g>d$. In order for this fixed point to be stable in the
direction associated with the non-zero eigenvalue then we have that
\begin{eqnarray*}
  p(\theta) & < & \frac{2cd}{g-d}.
\end{eqnarray*}

\textcolor{blue}{Replace above with:}

At the fixed point $b=1$, $w=0$, the Jacobian is given by 
\begin{eqnarray*}
  J~\bigg|_{(1,0)} & = & \left[
          \begin{array}{cc}
            -p(\theta) & -\frac{p(\theta)}{c+p(\theta)} \\
            0 & -d+\frac{gp(\theta)}{c+p(\theta)}
          \end{array}
          \right].
\end{eqnarray*}

This fixed point is unstable as long as $p(\theta) >\frac{dc}{g-d}$.  This condition is equivalent to $b^* < 1$.  (If on the other hand, $p(\theta) <\frac{dc}{g-d}$, then the equilibrium $(b^*,w^*)$ moves into the fourth quadrant ($w^*<0$) and the equilibrium $(1,0)$ is a stable attractor.)

\textcolor{blue}{I suggest replacing Appendix B with the following}

\textbf{NEW TITLE:  Limit Cycles}

In section 3.3 we showed that there is an equilibrium solution $(b^*,w^*)$ in the positive quadrant for the ODE system under the conditions:  1.)  $g-d>0$, and 2.) $\frac{cd}{g-d}<p(\theta)$.   Here, the values of  $p(\theta)$ are constrained by $1<p(\theta)<1+m$.   We also showed in that section that this 
equilibrium is stable under the condition that $\frac{p-c}{2} < \frac{cd}{g-d}.$   In this appendix, we prove the existence of a limit cycle when this latter inequality fails, i.e. the equilibrium becomes unstable.

We begin by remarking that the positive quadrant of the $(b,w)$-plane is invariant under the flow of the ODE system.

\begin{lemma}


All solutions of equations (\ref{eq:scaledODE1}) and
  (\ref{eq:scaledODE2}) with initial values
  $b\left( 0\right) > 0 ,w\left( 0\right) >0$ remain in the positive quadrant, $\mathbb R_+^2$, for all time.
\end{lemma}

\begin{proof}
  This follows by noticing that the non-negative axes, $\{(b,0):\  b \ge 0\}$ and $\{(0,w):\  w\ge 0\}$ are invariant under the flow.  Then, by uniqueness, we conclude that no flow line can pass from the positive quadrant through these axes.
\end{proof}

We next show that all solutions in the positive quadrant are bounded for all positive time.  

\begin{lemma}
There exists $R_{0}>0$  such that for all $R\geq R_{0}$, the right
triangle, 
$$T_{R}=\left\{ \left(b,w\right) \in \mathbb R^{2}:\  b\ge 0, w\ge 0, \ {\rm and}\  b+\frac{1}{g}w\le R\right\}, $$  
is positively invariant.
\end{lemma}

\begin{proof}
  We first note that if for some $t_0$, $b(t_0)< 1,$ then $b(t) < 1$ for all $t>t_0$.  This follows from the fact that equation (\ref{eq:scaledODE1}) shows that 
  $$\frac{d}{dt}b(t) < 0,\  \  {\rm when}\ \ b(t)\ge 1.$$
  
  Now, since we have already discussed that solutions in the positive quadrant cannot cross the axes, it is only left to show that we can choose $R_0$ large enough so that if $R>R_0$, we have
  $$\frac{d}{dt}(b(t)+\frac{1}{g}w(t)) <0,\  {\rm when}\  b(t)+\frac{1}{g}w(t) =R.$$
  
  But from equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}), we have
  $$\frac{d}{dt}(b(t)+\frac{1}{g}w(t))  =\left( p\left( \theta \right) b(t)\left( 1-b(t)\right) -\frac{d}{g}
w\left( t\right) \right). $$

If $b(t) \ge 1$, the right hand side in negative.  On the other hand, if $b(t) < 1$, we use $\frac{d}{g}w(t) = d(R-b(t))$ to get
$$\frac{d}{dt}(b(t)+\frac{1}{g}w(t)) =p\left( \theta \right) b(t)\left(
1-b(t)\right) -d\left( R-b(t)\right),$$
which is negative if $R>R_0= \frac{p(\theta)}{d} +1.$
\end{proof}

Finally, applying the Poincair'e--Bendixson theorem \citep{nonlinearChaos}, together with the above lemma, we have

\begin{theorem}
  If $0 < \frac{cd}{g-d} < \frac{p(\theta) -c}{2}$, then there exists at least one  limit cycle solution to equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) in the positive quadrant.
\end{theorem}

Summarizing the results of Apendices A and B, we have

\begin{theorem}
  The system of ordinary differential equations given by equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) (with $g\ne d)$ has fixed points in the $(b,w)$-plane at the points $(0,0), (1,0),$ and $(b^*,w^*)$, where $b^*=\frac{cd}{p(\theta)(g-d)}$ and
$w^*=\left(\frac{cd}{g-d}+c\right)\left(1-\frac{cd}{p(\theta)(g-d)}\right)$. 
 The  fixed point $(b^*,w^*)$ lies in the positive quadrant if $g-d>0$ and $u<p$, where $u=\frac{cd}{g-d}.$
Furthermore, this fixed point is asymptotically stable when $u>\frac{p-c}{2}$ and is unstable if $u<\frac{p-c}{2}.$ However, all positive solutions to the system are bounded, and when this fixed point is unstable, there exists at least one  limit cycle in the positive quadrant.
Finally, the fixed point $(0,0)$ is always an unstable saddle point, and the fixed point $(1,0)$ is unstable when $u<p$, otherwise it is stable.
\end{theorem}
\section{Stability of the Equilibria}
\label{appendix:stability}

The linear stability with respect to the parameters for the
non-trivial fixed points is examined in subsection 
\ref{subsection:parameters}. We now turn our attention to the
existence of limit cycles or oscillatory behaviour of the solutions
near the equilbria. Consider the model system, equations
(\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}). Can the impact
associated with the use of the anti-pheromone destabilize/stabilize
this equilibrium? If so, under what conditions? This is settled via
the following lemma,
\begin{theorem}
  \bigskip\ All solutions of equations (\ref{eq:scaledODE1}) and
  (\ref{eq:scaledODE2}) with initial values
  $b\left( 0\right) ,w\left( 0\right) >0$ are always non-negative
\end{theorem}


\begin{proof}
  Notice that equations (\ref{eq:scaledODE1}) and
  (\ref{eq:scaledODE2}) have the form
\begin{eqnarray}
  b^{\prime}\left( t \right) & = & b(t)X\left( b,w\right), \\
  w^{\prime}\left( t \right) & = & w(t)Y\left( b,w\right)
\end{eqnarray}


If $\ \left( b\left( t\right) ,w\left( t\right) \right)
$ is a solution of such a system, then using an integrating factor
\begin{eqnarray}
\dfrac{d}{dt}\left( e^{\left( -\int_{0}^{t}X(s)ds\right) }b(t)\right) & = & 0
\end{eqnarray}
Consequently,
\begin{eqnarray}
b(t) & = & e^{\left( -\int_{0}^{t}X(s)ds\right) }b(0), \\
w(t) & = & e^{\left( -\int_{0}^{t}Y(s)ds\right) }w(0).
\end{eqnarray}
So for all $t>0$ and $b\left( 0\right) ,w\left( 0\right) >0$ .
\end{proof}

Having established that the solutions are non-negative our attention
now turns to whether or not the solutions are bounded. We can state
that the solutions are bounded in the first quadrant.
\begin{lemma} \label{mm}
All the solutions of the system (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) which start in $R_{+}^{2}$ are
uniformly bounded. Furthermore There exists $R_{0}>0$  such that for all $R\geq R_{0}$, the right
triangle $T_{R}$ with sides $b=0, w=0$ and $R=b+\frac{1}{g}w $ is positively invariant.
\end{lemma}

\begin{proof}
For all $R>0$, consider the triangular regions $T_{R}=\left\{ \left(b(t),w(t)\right) \in R_{+}^{2}:R=b+\frac{1}{g}w\right\} $\\
Let's assume that $b(t),w(t)$ are any positive solution of system (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}),
then it is obvious that

$$\frac{d}{dt}b(t)\leq \hat{p}\left( \theta \right) b(t)\left( 1-b(t)\right) $$

We can see from the comparison argument that

$$0\leq b(t)\leq 1$$
Now since every initial point $b(0),w(0)\in R^{+}$ satisfies $b(0),w(0)\in T_{R}$ for some $R\geq R_{0}$, this shows that all solutions starting in $R^{+}$ are bounded for $t\geq 0$.\\
We claim that $T_{R}$ is forward invariant for all sufficiently large $R.$ We
need only to show that solutions cannot leave $T_{R}$\\
Since $R=b+\frac{1}{g}w $, 
it is enough to show that $\frac{d}{dt}\left( b(t)+\frac{1}{g}w(t)\right)\geq 0$

$$\frac{d}{dt}\left( b(t)+\frac{1}{g}w(t)\right)
=\left( \hat{p}\left( \theta \right) b(t)\left( 1-b(t)\right) -\frac{d}{g}%
w\left( t\right) \right) $$

$$ =\hat{p}\left( \theta \right) b(t)\left(
1-b(t)\right) -d\left( R-b(t)\right) \leq 0$$

if $R$ is chosen large enough.
\end{proof}

\begin{theorem}
  \index{3} Consider the model equations (\ref{eq:scaledODE1}) and
  (\ref{eq:scaledODE2}). Assume that  $g>d$.
 
\end{theorem}

\begin{description}
\item[1]  If $%
p(\theta )=c+\dfrac{2cd}{g-d},$ then the non trivial equilibrium $%
E^{\ast }=(b^{\ast },w^{\ast })$ is center.

\item[2] If $0<p(\theta )<c+\dfrac{2cd}{g-d}$ then the non trivial
equilibrium $E^{\ast }=(b^{\ast },w^{\ast })$ is locally stable.
\end{description}

\begin{proof}
  The non trivial equilibrium $E^{\ast }=(b^{\ast },w^{\ast })$ of the
  model equations (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) will
  be center if $DetJ>0$ and $TraceJ=0$

since $DetJ>0$ all the time then the it only depend on the value of the $%
TraceJ$
\begin{center}
$TraceJ=J_{11}=00$

iff $p(\theta )b^{\ast }\left( -1+\dfrac{p(\theta )w^{\ast }}{%
\left( c+p(\theta )b^{\ast }\right) ^{2}}\right) =0$

iff $p(\theta )w^{\ast }=\left( c+p(\theta )b^{\ast }\right)
^{2} $

iff $p(\theta )\left( 1-b^{\ast }\right) =\left( c+p(\theta
)b^{\ast }\right) $

iff $p(\theta )-2p(\theta )b^{\ast }=c$

iff $p(\theta )-\dfrac{2cd}{g-d}=c$

if $p(\theta )=c+\dfrac{2cd}{g-d}$
\end{center}

\end{proof}
\begin{figure}[!htp]
\begin{center}
\includegraphics[scale=0.3]{FIGURES/s.eps}  

\end{center}

\caption{Figure shows sample runs of $b(t)$ and $w(t)$ for equations
  (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}), where
  $p(\theta )$ = 3, where the system is stable }
      \label{fig:S}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!htp]
\begin{center}
\includegraphics[scale=0.28]{FIGURES/l1.eps}  
\includegraphics[scale=0.28]{FIGURES/l2.eps}

\end{center}

\caption{Figure shows runs of $b(t)$ and $w(t)$ for equations
  (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) has center
  equilibrium point, where $p(\theta )=3.92$. }
      \label{fig:l1l2}
\end{figure}

In the next theorem we aim to investigate the effect of the impact
associated with the use of the anti-pheromone $p(\theta )$ on
the limit cycle dynamics in equations (\ref{eq:scaledODE1}) and
(\ref{eq:scaledODE2}).

\begin{theorem}
  \index{4} Consider the model equations (\ref{eq:scaledODE1}) and
  (\ref{eq:scaledODE2}). Assume that $E^{\ast }=(b^{\ast },w^{\ast })$
  is the positive non trivial equilibrium point of the model equations
  (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) with \ $g>d$ and the
  following condition hold
\end{theorem}

\begin{center}
$%
p(\theta )>c+\dfrac{2cd}{g-d}>0,$
\end{center}

then the system possesses at least one closed loop in the first quadrant.

\begin{proof}
  From the local stability analysis, we have that if the above
  conditions hold, then the positive equilibrium
  $E^{\ast }=(b^{\ast },w^{\ast })$ of equations (\ref{eq:scaledODE1})
  and (\ref{eq:scaledODE2}) is an unstable node or focus. The
  existence of a closed loop now follows from Lemma \ref{mm} and
  Poincair'e--Bendixson theorem \citep{nonlinearChaos}.
\end{proof}

\begin{figure}[!htp]
\begin{center}
\includegraphics[scale=0.3]{FIGURES/lim.eps}  

\end{center}

\caption{Figure shows sample runs of $b(t)$ and $w(t)$ for equations
  (\ref{eq:scaledODE1}) and (\ref{eq:scaledODE2}) , where
  $p(\theta )$ = 4, where the system has a limit cycle }
      \label{fig:lim}
\end{figure}


\section{Numerical Approximation of the Coupled PDE and ODE system}
\label{numericalApproximation}

We introduce the method for the numerical approximation of the coupled
PDE and ODE system in equations (\ref{eq:scaledodePDE1}) and
(\ref{eq:scaledodePDE2}). For the full system, we make use of a
Legendre pseudo-spectral collocation
method\citep{spectralMethodsFluids,hesthaven_gottlieb_gottlieb_2007,gottlieb1977numerical}. First,
the butterfly density is discretized in $\theta$ as
\begin{eqnarray}
  \label{eqn:spatialDiscretization}
  b_N(t,\theta) & = & \sum^N_{i=0} \hat{b}_i(t) \phi_i(\theta),
\end{eqnarray}
where $\phi_i(\theta)$ is the Lagrange interpolant on the
$i$\textsuperscript{th} abscissa of the Legendre-Gauss-Lobatto
quadrature\citep{hesthaven_gottlieb_gottlieb_2007}.

The abscissa of the Legendre-Gauss-Lobatto quadrature are the zeroes
of the function
\begin{eqnarray}
  \psi(\theta) & = & \left(1-\theta^2\right) L_{N}'(\theta),
\end{eqnarray}
where $L_N(\theta)$ is the $n$\textsuperscript{th} Legendre
polynomial\citep{davis2007methods}.  The weights, $w_n$, associated
with the quadrature are identical to those described in
Davis\citep{davis2007methods} as well as Golub and
Welsch\citep{gaussQuadratureRules}. In our examples the quadrature is
approximated using the methods described by Golub and
Welsch\citep{gaussQuadratureRules}.  Given $\psi(\theta)$ the Lagrange
interpolants can be calculated
\begin{eqnarray}
  \phi_i(\theta) & = & \frac{\psi(\theta)}{\psi'(\theta)(\theta-\theta_i)}.
\end{eqnarray}
The function $\psi(\theta)$ coincides with the Legendre differential
equation, and the relationship can be simplified as
\begin{eqnarray}
  \psi'(\theta) & = & -N(N+1)L_N(\theta).
\end{eqnarray}

The discretization of equations (\ref{eq:scaledodePDE1}) and
(\ref{eq:scaledodePDE2}) is constructed by substituting the definition
of $b_N$ from equation (\ref{eqn:spatialDiscretization}). A Galerkin
approximation is constructed, and one minor complication is that the
Lagrange interpolants are polynomials of degree $N$, and the
Gauss-Lobatto quadrature is exact for polynomials up to degree
$N$. The integral is approximated using the Gauss-Lobatto quadrature,
and the resulting sum results in an equivalent norm compared to the
Gauss quadrature which is exact for polynomials up to degree
$N$\citep{SobolevCanutoQuarteroni}.

The resulting variational form for Neumann boundary conditions using a
Galerkin approximation and a discrete inner product for equation
(\ref{eq:scaledodePDE1}) is
\begin{eqnarray}
  \sum_{j=0}^N \sum_{i=0}^N  \hat{b}_i'(t) \phi_i(\theta_j) \phi_k(\theta_j) w_j
  & = &
  \sum_{j=0}^N \sum_{i=0}^N p(\theta_j)  \hat{b}_i(t) (1 - \hat{b}_i(t) ) \phi_i(\theta_j) \phi_k(\theta_j) w_j \\
  & &  -  \sum_{j=0}^N w(t) \frac{p(\theta_j) \sum_{i=0}^N \hat{b}_i(t) \phi_i(\theta_j) }{c+p(\theta_j) \sum_{i=0}^N \hat{b}_i(t) \phi_i(\theta_j)} \phi_k(\theta_j) w_j \nonumber \\ 
  & & - \sum_{j=0}^N \mu  \sum_{i=0}^N \hat{b}_i(t) \phi_i'(\theta_j) \phi_k'(\theta_j)  w_j, \nonumber
\end{eqnarray}
for all integer values of $k$ from $0$ to $N$ inclusive.  The basis
functions are the Lagrange interpolants on the abscissa, and the
equations can be reduced to
\begin{eqnarray}
  \hat{b}_k'(t) 
  & = &
        p(\theta_j) \hat{b}_k(t) (1 - \hat{b}_k(t) )
        -  w(t) \frac{p(\theta_k) \hat{b}_k(t)) }{c+p(\theta_k)  \hat{b}_k(t) }  
   - \frac{\mu}{w_k} \sum_{i=0}^N \hat{b}_i(t) \left( \sum_{j=0}^N  \phi_i'(\theta_j) \phi_k'(\theta_j)  w_j \right).
\end{eqnarray}
The corresponding discretization of the equation for the wasps is can be simplified because the moth population is defined on the Gauss-Labotto points,and the integral can be approximated as described above. A similar approach has been described by \cite{doi:10.1002/mma.1318}.

Combined with equation (\ref{eq:scaledodePDE2}) the approximation
consists of a system of $N+2$ ordinary differential equations. The
integral in equation (\ref{eq:scaledodePDE2}) is approximated using
the Legendre-Gauss-Lobatto quadrature. The temporal discretization of
the resulting system is constructed using a second order, implicit
multi-step scheme. The scheme is implemented as a fully implicit
second order Adams-Moulton scheme\citep{ascher2011first}. At each time
step the resulting non-linear system is approximated using Newton's
method.



\clearpage
%\bibliographystyle{siam}
\bibliographystyle{elsarticle-harv}
\bibliography{animalBehaviour}



\end{document}
